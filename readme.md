# GoEuro Bus Route Challenge

## Project
Author: Mark Ashton

Date: April 2017

A micro service that provides a ReST API for determining if there is a direct connection between stations on a bus route.
Bus routes are extracted from a data file (supplied via command line arguments).

## Requirements
Requirements are here: https://github.com/goeuro/challenges/tree/master/bus_route_challenge

Folder ./requirements contains the readme.md file from the github project above, which specifies requirements.

## Overview
The micro service is implemented using Spring Boot and Java 8.

The project is split into the following packages:

- priv.mashton.goeuro: contains the main Spring Boot application and a CliRunner for processing the filename argument and triggering model population
- priv.mashton.goeuro.busrouteimporter: Responsible for importing bus route data into the model
- priv.mashton.goeuro.controllers: contains rest controllers
- priv.mashton.goeuro.dtos: contains dtos (e.g. response dto)
- priv.mashton.goeuro.model: contains the models and their associated logic
- priv.mashton.goeuro.service: a lightweight service that forms a bridge between controller and model

Overview of folder structure:

- ./ : contains scripts for building and managing the service (start|stop|status|block) as well as the Maven pom file
- ./requirements: contains a copy of the requirements from the goeuro github project
- ./src/main: implementation
- ./src/test: automated tests (see testing section for an overview of tests)
- ./target: contains target jar (see the following sections for building/running)
- ./tests: contains files from goeuro github repo along with test files for the automated tests

### Building
build.sh: Execute this bash script to build the project, run automated tests, and package the micro service into a jar in the target folder.

### Running
service.sh: This bash script supports start|stop|status|block operations. The script makes use of an application.pid file generated by the
micro service but also uses pgrep as a backup when no pid file is available (e.g. accidental deletion).

Executing the script without parameters (i.e. "$ ./service.sh") will display information on using service.sh with parameters.

To start the service with a data file: $ ./service.sh start my-data-file.txt

Note1: service.sh does not work on Microsoft Windows systems. See testing section for more information. Otherwise run: java -jar <jar-file> <data-file>

Note2: Please note that the micro service still runs if the input file is invalid or missing. Check the log for more detail.

### Configuring memory
I have added a todo to the service.sh with some commented lines allowing for configuration of max heap

### Testing
- A suite of automated tests are provided (unit tests, integration tests, and application tests).
- No performance or scaling tests are included.
- This project has been tested on the following platforms:
    - OSX: build, automated tests, manual tests, goeuro local tests, goeuro docker tests
    - Ubuntu 16.04 LTS: build, automated tests, manual tests, go euro local tests
    - Microsoft Windows 10 (Git Bash): build, automated tests, manual tests. Note: service.sh does not work on windows; therefore it is necessary to manually run 
    the jar on this system. This also means it is not currently possible to use the goeuro local/docker tests on Windows.

## Notes
- The micro service still runs if the data file is not found or data is invalid. Please check the log.
- I assume that bus routes are bidirectional. This facilitates the use of a HashSet which also prevents duplicate stations.
- I assume that "direct connection" means that stations on a route are directly connected only if both are on the same route. It's opposite, an "indirect-connection" is when a route from stationA to stationB must use more than one bus route. This feature could be added later but would require changes to the model.

## Todo
- add more application and integration tests to cover more cases including corner cases
- modify service.sh to report successful start (including other todos documented in service.sh)

